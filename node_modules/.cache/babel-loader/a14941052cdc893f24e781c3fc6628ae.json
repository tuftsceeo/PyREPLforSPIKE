{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/gsess/Documents/React/repl/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/gsess/Documents/React/repl/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/gsess/Documents/React/repl/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import SerialButton from\"./SerialButton\";import APIButton from\"./APIButton\";import Tooltip from\"@mui/material/Tooltip\";import PlayCircleIcon from'@mui/icons-material/PlayCircle';import StopCircleIcon from'@mui/icons-material/StopCircle';import RestartAltIcon from'@mui/icons-material/RestartAlt';import Fab from'@mui/material/Fab';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VENDOR_ID=0x0694;// LEGO SPIKE Prime Hub\nvar port=null;var CONTROL_C='\\x03';// CTRL-C character \nvar CONTROL_D='\\x04';// CTRL-D character\nvar ENTER='\\r\\n';// NEWLINE character\nvar docsLink=\"https://tufts-cr-for-lego.codingrooms.com/documentation/spike_prime_python_knowledge_base#top\";var isWriteInit=false;var textEncoder;var writableStreamClosed;var writer;function Serial(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),stopCode=_useState2[0],setStopCode=_useState2[1];/*\r\n        InitWebSerial\r\n        - Initializes a Web Serial Port and returns the initialized port\r\n        - Returns the port if successful, null otherwise\r\n    */function initWebSerial(){return _initWebSerial.apply(this,arguments);}function _initWebSerial(){_initWebSerial=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return navigator.serial.getPorts();case 2:port=_context2.sent;_context2.next=5;return navigator.serial.requestPort();case 5:port=_context2.sent;_context2.prev=6;_context2.next=9;return port.open({baudRate:115200});case 9:_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](6);console.log(\"%cTuftsCEEO \",\"color: #3ba336;\",_context2.t0);//await port.close();\ncase 14:if(!port.readable){_context2.next=18;break;}return _context2.abrupt(\"return\",true);case 18:return _context2.abrupt(\"return\",false);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[6,11]]);}));return _initWebSerial.apply(this,arguments);}var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),readSerialPort=_useState4[0],setReadSerialPort=_useState4[1];// Reads Data from the SPIKE Prime (Uint8Array Format)\nfunction readPort(){return _readPort.apply(this,arguments);}function _readPort(){_readPort=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var decoder,inputDone,inputStream,reader,_yield$reader$read,value,done;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// eslint-disable-next-line no-undef\ndecoder=new TextDecoderStream();inputDone=port.readable.pipeTo(decoder.writable);inputStream=decoder.readable;reader=inputStream.getReader();case 4:if(!(port.readable&&readSerialPort)){_context3.next=27;break;}_context3.prev=5;case 6:if(!true){_context3.next=17;break;}_context3.next=9;return reader.read();case 9:_yield$reader$read=_context3.sent;value=_yield$reader$read.value;done=_yield$reader$read.done;if(!done){_context3.next=14;break;}return _context3.abrupt(\"break\",17);case 14:props.exportConsole(value);_context3.next=6;break;case 17:_context3.next=22;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](5);console.error(_context3.t0);case 22:_context3.prev=22;reader.releaseLock();return _context3.finish(22);case 25:_context3.next=4;break;case 27:case\"end\":return _context3.stop();}}},_callee3,null,[[5,19,22,25]]);}));return _readPort.apply(this,arguments);}function initWriteStream(){// eslint-disable-next-line no-undef\ntextEncoder=new TextEncoderStream();writableStreamClosed=textEncoder.readable.pipeTo(port.writable);writer=textEncoder.writable.getWriter();}// Writes a string (or array of strings) to the SPIKE terminal\nfunction writeToPort(_x){return _writeToPort.apply(this,arguments);}// Writes and reads code to/from serial port\nfunction _writeToPort(){_writeToPort=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(lines){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!isWriteInit){try{initWriteStream();isWriteInit=true;}catch(e){console.error(\"Unable to initialize stream\");}}if(!(writer==undefined)){_context4.next=5;break;}console.error(\"Error: Writer Not Defined\");_context4.next=15;break;case 5:_context4.next=7;return writer.write(ENTER);case 7:if(!(typeof lines===\"string\")){_context4.next=12;break;}_context4.next=10;return writer.write(lines);case 10:_context4.next=13;break;case 12:if(typeof lines===\"object\"){lines.forEach(function(element){if(!stopCode){writer.write(element);}});}case 13:writer.write(ENTER);if(stopCode){setStopCode(false);}case 15:case\"end\":return _context4.stop();}}},_callee4);}));return _writeToPort.apply(this,arguments);}function startWebSerial(){return _startWebSerial.apply(this,arguments);}function _startWebSerial(){_startWebSerial=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return initWebSerial();case 2:if(!_context6.sent){_context6.next=8;break;}_context6.next=5;return writeToPort([CONTROL_C]);case 5:_context6.next=7;return writeToPort([\"from spike import PrimeHub, LightMatrix, Button, StatusLight, ForceSensor, MotionSensor, Speaker, ColorSensor, App, DistanceSensor, Motor, MotorPair\"]);case 7:setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:readPort();case 1:case\"end\":return _context5.stop();}}},_callee5);})),250);case 8:case\"end\":return _context6.stop();}}},_callee6);}));return _startWebSerial.apply(this,arguments);}function closePort(){port.close();}// Serial Port UI Component Hooks\nvar defaultDirections=\"SPIKE Not Connected, Connect Here: \";var activeSerialDirections=\"\";var _useState5=useState(defaultDirections),_useState6=_slicedToArray(_useState5,2),connectText=_useState6[0],setConnectText=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),serialOn=_useState8[0],setSerialOn=_useState8[1];// Changes functionality of serial port button once serial port is connected\nfunction serialButtonConnected(){var checkConnectionInterval;setTimeout(function(){checkConnectionInterval=setInterval(function(){if(port.readable){setSerialOn(true);setConnectText(activeSerialDirections);}else if(port===null||port===undefined||!port.readable){//clearInterval(checkConnectionInterval);\nsetSerialOn(false);setConnectText(defaultDirections);}},1000);},500);}// Attempts a WebSerial Connection (associated with button press)\nfunction connectToSPIKE(){startWebSerial();serialButtonConnected();}function strToASCII(s){var charCodeArr=[];for(var i=0;i<s.length;i++){var code=s.charCodeAt(i);charCodeArr.push(code);}return charCodeArr;}function runCurrentCode(){// Adds appropriate spaces at end of code to\n// make sure the Python interpreter knows to run\n// the code.\nvar currentCode=props.getCurrentCode();var codeArray=currentCode.split(\"\\n\");var indentedCodeArray=[];for(var i=0;i<codeArray.length;i++){var curElement=codeArray[i];// If there's a colon, check if it's in a string or used for a\n// conditional/loop/function\nvar splitByColon=curElement.split(\":\");if(splitByColon.length>1){curElement=splitByColon[0]+\": \\r\\n\";}else{curElement+=\"\\r\\n\";}var indented=false;if(curElement.length>=4&&curElement.substring(0,4)===\"    \"){if(i>0&&codeArray[i-1].length>=4&&codeArray[i-1].substring(0,4)==\"    \"){curElement=curElement.substring(4);}indented=true;}indentedCodeArray.push(curElement);if(indented){if(i<codeArray.length-1&&codeArray[i+1].substring(0,4)!=\"    \"){indentedCodeArray.push(\"\\r\\n\\r\\n\\r\\n\");}else if(i>=codeArray.length-1){indentedCodeArray.push(\"\\r\\n\\r\\n\\r\\n\");}}}writeToPort([].concat(indentedCodeArray));console.log([].concat(indentedCodeArray));}// When CRTL + ENTER is pressed, code is run\n// https://stackoverflow.com/questions/37440408/how-to-detect-esc-key-press-in-react-and-how-to-handle-it\nuseEffect(function(){var handleEsc=function handleEsc(event){if(event.keyCode===13&&event.ctrlKey)runCurrentCode();};window.addEventListener('keydown',handleEsc);return function(){window.removeEventListener('keydown',handleEsc);};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center\",children:[/*#__PURE__*/_jsx(SerialButton,{on:serialOn,offColor:\"error\",onColor:\"success\",connectText:connectText,onClick:function onClick(){connectToSPIKE();},restartClick:closePort,getCurrentCode:props.getCurrentCode,runCurrentCode:writeToPort}),/*#__PURE__*/_jsx(\"div\",{className:!serialOn?\"hidden\":\"mx-4\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"Restart SPIKE\",placement:\"top\",children:/*#__PURE__*/_jsx(Fab,{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return writeToPort(CONTROL_D);case 2:_context.next=4;return writeToPort(CONTROL_C);case 4:case\"end\":return _context.stop();}}},_callee);})),color:\"warning\",\"aria-label\":\"add\",size:\"small\",children:/*#__PURE__*/_jsx(RestartAltIcon,{})})})}),/*#__PURE__*/_jsx(\"div\",{className:!serialOn?\"hidden\":\"mx-4\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"Run Current File\",placement:\"top\",children:/*#__PURE__*/_jsx(Fab,{onClick:runCurrentCode,color:\"info\",\"aria-label\":\"add\",size:\"small\",children:/*#__PURE__*/_jsx(PlayCircleIcon,{})})})}),/*#__PURE__*/_jsx(\"div\",{className:!serialOn?\"hidden\":\"mr-4\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"Stop\",placement:\"top\",children:/*#__PURE__*/_jsx(Fab,{onClick:function onClick(){setStopCode(true);},color:\"error\",\"aria-label\":\"add\",size:\"small\",children:/*#__PURE__*/_jsx(StopCircleIcon,{})})})}),/*#__PURE__*/_jsx(APIButton,{link:docsLink,on:serialOn,color:\"inherit\"})]});}export default Serial;","map":{"version":3,"names":["React","useState","useEffect","SerialButton","APIButton","Tooltip","PlayCircleIcon","StopCircleIcon","RestartAltIcon","Fab","VENDOR_ID","port","CONTROL_C","CONTROL_D","ENTER","docsLink","isWriteInit","textEncoder","writableStreamClosed","writer","Serial","props","stopCode","setStopCode","initWebSerial","navigator","serial","getPorts","requestPort","open","baudRate","console","log","readable","readSerialPort","setReadSerialPort","readPort","decoder","TextDecoderStream","inputDone","pipeTo","writable","inputStream","reader","getReader","read","value","done","exportConsole","error","releaseLock","initWriteStream","TextEncoderStream","getWriter","writeToPort","lines","e","undefined","write","forEach","element","startWebSerial","setTimeout","closePort","close","defaultDirections","activeSerialDirections","connectText","setConnectText","serialOn","setSerialOn","serialButtonConnected","checkConnectionInterval","setInterval","connectToSPIKE","strToASCII","s","charCodeArr","i","length","code","charCodeAt","push","runCurrentCode","currentCode","getCurrentCode","codeArray","split","indentedCodeArray","curElement","splitByColon","indented","substring","handleEsc","event","keyCode","ctrlKey","window","addEventListener","removeEventListener"],"sources":["C:/Users/gsess/Documents/React/repl/src/components/Serial/Serial.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\r\nimport SerialButton from \"./SerialButton\";\r\nimport APIButton from \"./APIButton\";\r\nimport Tooltip from \"@mui/material/Tooltip\";\r\nimport PlayCircleIcon from '@mui/icons-material/PlayCircle';\r\nimport StopCircleIcon from '@mui/icons-material/StopCircle';\r\nimport RestartAltIcon from '@mui/icons-material/RestartAlt';\r\nimport Fab from '@mui/material/Fab';\r\n\r\n\r\nconst VENDOR_ID = 0x0694; // LEGO SPIKE Prime Hub\r\n\r\nlet port = null;\r\n\r\nconst CONTROL_C = '\\x03'; // CTRL-C character \r\nconst CONTROL_D = '\\x04'; // CTRL-D character\r\nconst ENTER = '\\r\\n' // NEWLINE character\r\n\r\nconst docsLink = \"https://tufts-cr-for-lego.codingrooms.com/documentation/spike_prime_python_knowledge_base#top\";\r\n\r\nlet isWriteInit = false;\r\nlet textEncoder;\r\nlet writableStreamClosed;\r\n\r\nlet writer;\r\n\r\n\r\nfunction Serial(props) {\r\n\r\n    let [stopCode, setStopCode] = useState(false);\r\n\r\n    /*\r\n        InitWebSerial\r\n        - Initializes a Web Serial Port and returns the initialized port\r\n        - Returns the port if successful, null otherwise\r\n    */\r\n    async function initWebSerial() {\r\n        port = await navigator.serial.getPorts();\r\n\r\n        port = await navigator.serial.requestPort(\r\n            \r\n        );\r\n\r\n        // wait for the port to open.\r\n        try {\r\n            await port.open({ baudRate: 115200 });\r\n        }\r\n        catch (er) {\r\n            console.log(\"%cTuftsCEEO \", \"color: #3ba336;\", er);\r\n            //await port.close();\r\n        }\r\n\r\n        if (port.readable) {\r\n            return true;\r\n            \r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    const [readSerialPort, setReadSerialPort] = useState(true);\r\n\r\n    // Reads Data from the SPIKE Prime (Uint8Array Format)\r\n    async function readPort() {\r\n        // eslint-disable-next-line no-undef\r\n        let decoder = new TextDecoderStream();\r\n        let inputDone = port.readable.pipeTo(decoder.writable);\r\n        const inputStream = decoder.readable;\r\n\r\n        const reader = inputStream.getReader();\r\n        while (port.readable && readSerialPort) {\r\n            //const reader = port.readable.getReader();\r\n            try {\r\n                while (true) {\r\n                const { value, done } = await reader.read();\r\n                if (done) {\r\n                    // |reader| has been canceled.\r\n                    break;\r\n                }\r\n                props.exportConsole(value);\r\n                }\r\n            } catch (error) {\r\n                console.error(error);\r\n            } finally {\r\n                reader.releaseLock();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    function initWriteStream() {\r\n        // eslint-disable-next-line no-undef\r\n        textEncoder = new TextEncoderStream();\r\n        writableStreamClosed = textEncoder.readable.pipeTo(port.writable);\r\n        writer = textEncoder.writable.getWriter();\r\n    }\r\n\r\n    // Writes a string (or array of strings) to the SPIKE terminal\r\n    async function writeToPort(lines) {\r\n        if (!isWriteInit) {\r\n            try {\r\n                initWriteStream()\r\n                isWriteInit = true;\r\n            }\r\n            catch (e) {\r\n                console.error(\"Unable to initialize stream\")\r\n            }\r\n        }\r\n\r\n        if (writer == undefined) {\r\n            console.error(\"Error: Writer Not Defined\");\r\n        }\r\n        else {\r\n            await writer.write(ENTER)\r\n\r\n            if (typeof(lines) === \"string\")\r\n                await writer.write(lines);\r\n            // Writes code one line at a time\r\n            else if(typeof(lines) === \"object\") {\r\n                lines.forEach( (element) => {\r\n                    if (!stopCode) {\r\n                        writer.write(element);\r\n                    }\r\n                });\r\n            }\r\n            writer.write(ENTER)\r\n\r\n            if (stopCode) {\r\n                setStopCode(false);\r\n            }\r\n\r\n        }\r\n        \r\n\r\n        \r\n    }\r\n\r\n    // Writes and reads code to/from serial port\r\n    async function startWebSerial() {\r\n        if (await initWebSerial()) {\r\n            await writeToPort([CONTROL_C]);\r\n            await writeToPort([\"from spike import PrimeHub, LightMatrix, Button, StatusLight, ForceSensor, MotionSensor, Speaker, ColorSensor, App, DistanceSensor, Motor, MotorPair\"])\r\n\r\n            setTimeout(async() => {\r\n                readPort()\r\n                \r\n            }, 250);\r\n\r\n            \r\n        }\r\n\r\n    }\r\n\r\n    function closePort() {\r\n        port.close()\r\n    }\r\n    \r\n    // Serial Port UI Component Hooks\r\n    const defaultDirections = \"SPIKE Not Connected, Connect Here: \";\r\n    const activeSerialDirections = \"\"\r\n    const [connectText, setConnectText] = useState(defaultDirections);\r\n    const [serialOn, setSerialOn] = useState(false);\r\n   \r\n\r\n    // Changes functionality of serial port button once serial port is connected\r\n    function serialButtonConnected() {\r\n        let checkConnectionInterval;\r\n        setTimeout(() => {\r\n            checkConnectionInterval = setInterval(() => {\r\n                if (port.readable) {\r\n                    setSerialOn(true);\r\n                    setConnectText(activeSerialDirections);\r\n                }\r\n                else if (port === null || port === undefined ||  !port.readable) {\r\n                    //clearInterval(checkConnectionInterval);\r\n                    setSerialOn(false);\r\n                    setConnectText(defaultDirections)\r\n\r\n                }\r\n                \r\n            }, 1000);\r\n        }, 500);\r\n        \r\n    }\r\n\r\n    // Attempts a WebSerial Connection (associated with button press)\r\n    function connectToSPIKE() {\r\n        startWebSerial(); \r\n        serialButtonConnected();\r\n    }\r\n\r\n    function strToASCII(s){\r\n        let charCodeArr = [];\r\n        \r\n        for(let i = 0; i < s.length; i++){\r\n            let code = s.charCodeAt(i);\r\n            charCodeArr.push(code);\r\n        }\r\n        \r\n        return charCodeArr;\r\n    }\r\n\r\n    function runCurrentCode() {\r\n\r\n        // Adds appropriate spaces at end of code to\r\n        // make sure the Python interpreter knows to run\r\n        // the code.\r\n        let currentCode = props.getCurrentCode();\r\n        let codeArray = currentCode.split(\"\\n\");\r\n        \r\n        let indentedCodeArray = [];\r\n        for (let i = 0; i < codeArray.length; i++) {\r\n            let curElement = codeArray[i];\r\n\r\n            // If there's a colon, check if it's in a string or used for a\r\n            // conditional/loop/function\r\n            let splitByColon = curElement.split(\":\");\r\n            if (splitByColon.length > 1) {\r\n                curElement = splitByColon[0] + \": \\r\\n\"\r\n            } \r\n            else {\r\n                curElement += \"\\r\\n\";\r\n            }\r\n\r\n            let indented = false;\r\n            if (curElement.length >= 4 && curElement.substring(0,4) === \"    \") {\r\n                if (i > 0 && codeArray[i-1].length >= 4 && codeArray[i-1].substring(0,4) == \"    \") {\r\n                    curElement = curElement.substring(4);\r\n                }\r\n                indented = true;\r\n            }\r\n\r\n            indentedCodeArray.push(curElement);\r\n\r\n            if (indented) {\r\n                if (i < codeArray.length - 1 && codeArray[i+1].substring(0,4) != \"    \") {\r\n                    indentedCodeArray.push(\"\\r\\n\\r\\n\\r\\n\")\r\n                } \r\n                else if (i >= codeArray.length - 1) {\r\n                    indentedCodeArray.push(\"\\r\\n\\r\\n\\r\\n\")\r\n                }\r\n            }\r\n            \r\n        }\r\n    \r\n        writeToPort([...indentedCodeArray]);\r\n        console.log([...indentedCodeArray]);\r\n    }\r\n\r\n    // When CRTL + ENTER is pressed, code is run\r\n    // https://stackoverflow.com/questions/37440408/how-to-detect-esc-key-press-in-react-and-how-to-handle-it\r\n    \r\n    useEffect(() => {\r\n        const handleEsc = (event) => {\r\n            if (event.keyCode === 13 && event.ctrlKey) \r\n                runCurrentCode();\r\n        };\r\n        window.addEventListener('keydown', handleEsc);\r\n\r\n        return () => {\r\n            window.removeEventListener('keydown', handleEsc);\r\n        };\r\n    }, []);\r\n    \r\n\r\n    return (\r\n        <div className=\"flex justify-center\">\r\n            \r\n            <SerialButton \r\n                on={serialOn} \r\n                offColor=\"error\"\r\n                onColor=\"success\" \r\n                connectText={connectText} \r\n                \r\n                onClick={() => {\r\n                    connectToSPIKE();\r\n                }} \r\n                restartClick={closePort} \r\n                getCurrentCode={props.getCurrentCode}\r\n                runCurrentCode={writeToPort}\r\n            />\r\n\r\n            <div className={!serialOn ? \"hidden\" : \"mx-4\"}>\r\n                <Tooltip title=\"Restart SPIKE\" placement=\"top\">\r\n                    <Fab \r\n                        onClick={async () => {\r\n                            await writeToPort(CONTROL_D);\r\n                            await writeToPort(CONTROL_C);\r\n                        }} \r\n                        color=\"warning\" \r\n                        aria-label=\"add\" \r\n                        size=\"small\">\r\n\r\n                        <RestartAltIcon />\r\n                    </Fab>\r\n                </Tooltip>\r\n            </div>\r\n\r\n            {/* RUN BUTTON Displayed when SPIKE IS connected */}\r\n            <div className={!serialOn ? \"hidden\" : \"mx-4\"}>\r\n                <Tooltip title=\"Run Current File\" placement=\"top\">\r\n                    <Fab \r\n                        onClick={runCurrentCode} \r\n                        color=\"info\" \r\n                        aria-label=\"add\" \r\n                        size=\"small\">\r\n\r\n                        <PlayCircleIcon />\r\n                    </Fab>\r\n                </Tooltip>\r\n            </div>\r\n\r\n            <div className={!serialOn ? \"hidden\" : \"mr-4\"}>\r\n                <Tooltip title=\"Stop\" placement=\"top\">\r\n                    <Fab \r\n                        onClick={() => {\r\n                            setStopCode(true);\r\n                        }} \r\n                        color=\"error\" \r\n                        aria-label=\"add\" \r\n                        size=\"small\">\r\n\r\n                        <StopCircleIcon />\r\n                    </Fab>\r\n                </Tooltip>\r\n            </div>\r\n\r\n            <APIButton link={docsLink} on={serialOn} color={\"inherit\"} />\r\n\r\n            \r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Serial;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}